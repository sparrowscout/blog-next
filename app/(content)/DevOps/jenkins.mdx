---
title: 'Jenkinsë¡œ ë°°í¬ ìë™í™” ì„¤ì •í•˜ê¸° (npm package)'
date: '2023-11-07'
excerpt: 'ğŸš¶ ë‚´ë¶€ SDKë¥¼ ë°°í¬í•  ë•Œ bitbucket push â†’ npm version & npm publish ìë™í™”ì‹œí‚¤ê³  ì‹¶ì–´ì„œ ì‚¬ìš©'
---

# Jenkinsë€?

âœï¸ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ì™€ ê´€ë ¨ëœ ëª¨ë“  ì¢…ë¥˜ì˜ ì‘ì—…ì„ ìë™í™”í•˜ëŠ”ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë…ë¦½í˜• ì˜¤í”ˆ ì†ŒìŠ¤ ìë™í™” ì„œë²„, ëŒ€ë¶€ë¶„ì˜ CI/CD ë°°í¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì˜ ê¸°ë³¸ì ì¸ êµ¬ì¡°ëŠ” Jenkinsì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤.<br/>

<br />

í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ë¥¼ ë°°í¬í•˜ê±°ë‚˜, ë‚´ë¶€ SDKë¥¼ ë°°í¬í•  ë•Œ ë°°í¬ ë‹¨ê³„ë¥¼ ìë™í™” ì‹œí‚¤ê³  ì‹¶ì–´ì„œ ì‚¬ìš©í•´ë³´ê²Œ ëìŠµë‹ˆë‹¤. ì‚¬ë‚´ git ì €ì¥ì†Œë¡œëŠ” bitbucketì„ ì‚¬ìš©í•˜ê³  ìˆì–´ì„œ bitbucket pipelineì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ ì˜¤íˆë ¤ Jenkinsë¡œ ì„¤ì •í•˜ëŠ”ê²Œ ì¶”í›„ í™•ì¥ì„±ì— ì¢‹ì„ ê²ƒ ê°™ì•„ì„œ Jenkinsë¥¼ ì„ íƒí–ˆìŠµë‹ˆë‹¤. <br/>

<br />

# ë°°í¬ ë‹¨ê³„ ê·¸ë ¤ë³´ê¸°

![ì  í‚¨ìŠ¤ë¥¼ ì´ìš©í•œ ë°°í¬ ë‹¨ê³„](</img/jenkins(2).png>)

ì  í‚¨ìŠ¤ë¥¼ ì´ìš©í•œ ë°°í¬ ë‹¨ê³„ë¥¼ í¬ê²Œë³´ë©´ ì´ë ‡ìŠµë‹ˆë‹¤.

1. ê°œë°œìê°€ íŠ¹ì • ì €ì¥ì†Œì— push
2. ì €ì¥ì†Œì™€ ì—°ê²°ëœ web hookì´ í•´ë‹¹ push ì´ë²¤íŠ¸ë¥¼ ì  í‚¨ìŠ¤ì—ê²Œ ì „ë‹¬
3. push ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬ë°›ì€ ì  í‚¨ìŠ¤ê°€ ì‘ì„±ëœ ìŠ¤í¬ë¦½íŠ¸ì— ë”°ë¼ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ ì§„í–‰

ì„¸ë¶€ì‚¬í•­ì€ ë¬¼ë¡  ì €ì¥ì†Œë§ˆë‹¤, ë°°í¬í•˜ë ¤ëŠ” í”„ë¡œì íŠ¸ë§ˆë‹¤ ë‹¤ë¥´ê² ì§€ë§Œ ì´ë ‡ê²Œ ì´í•´í•˜ê³  ë‹¤ê°€ê°€ì•¼ ì¥ë²½ì´ ì¢€ ë‚®ì•„ì§€ëŠ” ëŠë‚Œì´ê³ , ì–´ë””ì— ë­˜ ì—°ê²°í•´ì„œ ë¬´ìŠ¨ ë°ì´í„°ë¥¼ ë³´ë‚´ëŠ”ì§€ ì´í•´ê°€ ë©ë‹ˆë‹¤.

<br />

## ì—°ê²°í•˜ê¸°

âœï¸ ì´ë²¤íŠ¸ê°€ í˜ëŸ¬ê°€ëŠ” íë¦„ì„ ë”°ë¼ ì—°ê²°í•´ì¤ë‹ˆë‹¤.

![ë¬´ì—‡ê³¼ ë¬´ì—‡ì„ ì—°ê²°í•´ì•¼í•˜ëŠ”ì§€](</img/jenkins(3).png>)

<br />

## íŒŒì´í”„ë¼ì¸ ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±í•˜ê¸°

âœï¸ í™•ì¥ì„±ì´ ì¢‹ë‹¤ëŠ” ë§ì€, í”ŒëŸ¬ê·¸ì¸ë„ ë§ê³  ì˜µì…˜ë„ ë§ê³  ì´ëŸ°ì €ëŸ° ì„ íƒì§€ê°€ ë§ì•„ì„œ ê·¸ ì¤‘ì— í”„ë¡œì íŠ¸ì— ë§ëŠ” ì„ íƒì„ í•´ì•¼í•œë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. ê°œë°œìê°€ ì›í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë¨¼ì € ì •í™•íˆ ì•Œê³  ìˆì–´ì•¼ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ì¤‘ê°„ì— íŒŒì´í”„ë¼ì¸ ì¢…ë¥˜ë¥¼ ë°”ê¿”ì•¼í•˜ê±°ë‚˜ í•˜ëŠ” ë¶ˆìƒì‚¬ë¥¼ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br/>

<br />

## ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±í•˜ê¸°

âœï¸ push ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ì„œ ì  í‚¨ìŠ¤ê°€ íŠ¸ë¦¬ê±°ëœ í›„, ì  í‚¨ìŠ¤ê°€ ì‹¤í–‰ì‹œí‚¬ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í•©ë‹ˆë‹¤. íŒŒì´í”„ë¼ì¸ ë¬¸ë²•ì—ëŠ” ì„ ì–¸ì  íŒŒì´í”„ë¼ì¸ê³¼ ìŠ¤í¬ë¦½íŠ¸ íŒŒì´í”„ë¼ì¸ì´ ìˆìŠµë‹ˆë‹¤. êµ¬ì¡°ëŠ” ë¹„ìŠ·í•©ë‹ˆë‹¤. ì €ëŠ” ì„ ì–¸ì  íŒŒì´í”„ë¼ì¸ ì•ˆì— ìŠ¤í¬ë¦½íŠ¸ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í–ˆìŠµë‹ˆë‹¤. <br/>

<br />

- ìŠ¤í¬ë¦½íŠ¸ ì˜ˆì‹œ

1.  git messageì™€ npm versionì„ ì²´í¬í•´ì„œ ë°°í¬í•˜ë ¤ê³  ê³ êµ°ë¶„íˆ¬ í–ˆë˜ JenkinsFile ....

```groovy
pipeline {
    agent any

    environment {
        GIT_MESSAGE = get_commit_msg()
    }

    tools {nodejs "NodeJS"}

    stages {
        stage('Hello') {
            steps {
                echo 'Hello...'
            }
        }

        stage('Build') {
            steps {
                    sh "git log -1"

            script {

                def npmVersion = get_npm_version()
                echo "${npmVersion}"
                echo "${env.GIT_MESSAGE}"
                echo "${env.GIT_MESSAGE}"
                echo "${env.GIT_COMMIT}"
                echo "${GIT_COMMIT}"
                def isUpdate = get_commit_subject("Update")
                def isFeature = get_commit_subject("Feature")
                def isMajor = isFeature == 0
                echo "${isUpdate}"
                echo "${isFeature}"
                echo "${isMajor}"
                if(isMajor){
                sh "npm version major"
                } else {
                sh "npm version minor"
                }
                echo "${npmVersion}"
                sh "git pull"
                sh "git pull origin ${BRANCH_NAME}"
                sh "git fetch origin ${BRANCH_NAME}"

                sh "git status"
                sh "git push --set-upstream origin ${BRANCH_NAME} --force"
                sh "git tag"
                sh "git config --list"

                sh "git push origin --tags"
                sh "npm publish"
              }
              }
          }
      }
  }

  def get_commit_msg(){
  script{
  return sh(script:"git show -s --format=%B ${env.GIT_COMMIT}", returnStdout:true).trim()
  }
  }

  def get_commit_subject(subject){
  script{
  return sh(script:"git show -s --format=%B ${env.GIT_COMMIT}", returnStdout:true).trim().indexOf(subject)
  }
  }

  def get_commit_author(){
  script{
  return sh(script:"git --no-pager show -s --format=%an ${env.GIT_COMMIT}",returnStdout:true).trim()
  }
  }

  def get_npm_version(){
  script{
  return sh(script:"npm show dummy-jenkins version",returnStdout:true).trim()
  }
  }
```

<br />

2.  ì²˜ìŒì— ì  í‚¨ìŠ¤ ì„¤ì • í›„ í…ŒìŠ¤íŠ¸í•˜ë ¤ê³  ì‘ì„±í–ˆë˜ Jenkins file

```groovy
pipeline {

    agent any

    tools {nodejs "NodeJS"}

    stages {

        stage('Hello') {
            steps {
                echo 'Hello..'
            }
        }

        stage('for the fix branch') {
            when {
                branch "fix-*"
            }
            steps {
                echo 'this only runs for the fix branches'
            }
        }

        stage('for the PR branch') {
            when {
                branch "PR-*"
            }
            steps {
                echo 'this only runs for the PR branches'
            }
        }
    }

}
```

<br />

## ì €ì¥ì†Œì— pushí•´ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸°

âœï¸ ì„¤ì •í•œ ì €ì¥ì†Œì— ìƒˆ push commitì„ ë„£ì–´ì„œ ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸í•´ë´…ì‹œë‹¤! <br/>

<br />

ìƒˆ push commitì„ ë„£ê³  Jenkinsì—ì„œ Stage ë³„ë¡œ ì§„í–‰ë˜ëŠ” ê²ƒì„ UIë¡œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- Stage View <br/>
  íŒŒì´í”„ë¼ì¸ì—ì„œ ì„¤ì •í•œ Stage ë³„ ê²½ê³¼ ì‹œê°„ê³¼ ì‹¤í–‰í•œ stepì„ ê°„ê²°í•˜ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Stage 'for the fix branch'ì—ì„œëŠ” ë¸Œëœì¹˜ ëª…ì´ fixë¡œ ì‹œì‘í•  ë•Œë§Œ stepì„ ì‹¤í–‰í•˜ë„ë¡ íŒŒì´í”„ë¼ì¸ì„ ì‘ì„±í–ˆê¸° ë•Œë¬¸ì— í˜„ì¬ ë¸Œëœì¹˜ì¸ PR-1ì—ì„œëŠ” ê±´ë„ˆë›´ ëª¨ìŠµì…ë‹ˆë‹¤.

  ![stageë³„ ì§„í–‰](</img/jenkins(4).png>)

- Scan Oragnization Folder Log (ìœ„ì˜ UIì—ì„œ ì†Œë¹„ ì‹œê°„ì„ í´ë¦­í•˜ë©´ logë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤) <br/>
  ì²˜ìŒì— ì—°ê²°í•˜ëŠ” ë‹¨ê³„ì—ì„œ ì˜ëª»ë˜ê±°ë‚˜, ìŠ¤í¬ë¦½íŠ¸ê°€ ì˜ëª»ëœ ê²½ìš° ë¡œê·¸ë¥¼ í™•ì¸í•˜ë©´ì„œ ë”°ë¼ê°€ë©´ ë””ë²„ê¹…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
