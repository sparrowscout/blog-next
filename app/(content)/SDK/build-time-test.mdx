---
title: 'Build Time Test'
date: '2023-11-07'
excerpt: 'ğŸ§ SDK íŒ¨í‚¤ì§•ì„ ìœ„í•´ ë²ˆë“¤ëŸ¬ íˆ´ê³¼ ì»´íŒŒì¼ íˆ´ì„ ë¹„êµí–ˆìŠµë‹ˆë‹¤. ë™ì¼í•œ ìš”êµ¬ì‚¬í•­ ë‚´ì—ì„œ ë²ˆë“¤ëŸ¬ë“¤ë¼ë¦¬ ë¹„êµí•œ ì´í›„, ì œì¼ ë¹ ë¥¸ íˆ´ê³¼ ì œì¼ ëŠë¦° íˆ´ì˜ loader, plugin ë“±ì„ ë³€ê²½í•´ì„œ í™˜ê²½ ì•ˆì—ì„œ ìµœì ì˜ ë°©ì‹ì„ ì°¾ì•„ë‚´ë ¤ê³  í–ˆìŠµë‹ˆë‹¤.'
---

SDK íŒ¨í‚¤ì§•ì„ ìœ„í•´ ë²ˆë“¤ëŸ¬ íˆ´ê³¼ ì»´íŒŒì¼ íˆ´ì„ ë¹„êµí–ˆìŠµë‹ˆë‹¤. ë™ì¼í•œ ìš”êµ¬ì‚¬í•­ ë‚´ì—ì„œ ë²ˆë“¤ëŸ¬ë“¤ë¼ë¦¬ ë¹„êµí•œ ì´í›„, ì œì¼ ë¹ ë¥¸ íˆ´ê³¼ ì œì¼ ëŠë¦° íˆ´ì˜ loader, plugin ë“±ì„ ë³€ê²½í•´ì„œ í™˜ê²½ ì•ˆì—ì„œ ìµœì ì˜ ë°©ì‹ì„ ì°¾ì•„ë‚´ë ¤ê³  í–ˆìŠµë‹ˆë‹¤.

[ğŸ± github repository ](https://github.com/sparrowscout/dummy-ESBuild)

# ë²ˆë“¤ëŸ¬ ëª©ë¡

1. **rollUp** : HLS.jsê°€ ì‚¬ìš©í•˜ê³  ìˆëŠ” ë²ˆë“¤ëŸ¬, ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒ¨í‚¤ì§•ì— ì ì ˆí•œ íˆ´
2. **webPack** : í´ë˜ì‹ì´ë¼ê³  ìƒê°ë˜ì–´ì„œ ëª©ë¡ì— ë„£ìŒ
3. **ESBuild** : LATESTì´ê¸°ë„í•˜ê³ , êµ‰ì¥íˆ ë¹ ë¥´ë‹¤ê³  ë“¤ì–´ì„œ ë¹„êµêµ°ì— ë„£ìŒ

<br />

# ë²ˆë“¤ ìš”êµ¬ì‚¬í•­

1. **input**: index.ts <br/>
   **output**: index.cjs(UMD), index.js(ESM), index.d.ts
   > Typescriptë¡œ ì‘ì„±ëœ ì›ë³¸ ì†ŒìŠ¤ 1ê°œë¡œ node ê¸°ë°˜ ëª¨ë“ˆê³¼ ë¸Œë¼ìš°ì € ê¸°ë°˜ ëª¨ë“ˆì„ í¬ê´„ì ìœ¼ë¡œ ì§€ì› í•˜ê¸° ìœ„í•´ UMD, ESM ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ë²ˆë“¤ + íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©ìë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ .d.ts íŒŒì¼ emit
2. minify: true

> ### UMDì™€ ESMì„ ì„ íƒí•œ ì´ìœ ?
>
> ### Javascript module
>
> 1.  **CommonJS** : ë§¨ ì²˜ìŒ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì›¹ ì´ì™¸ í™˜ê²½, node ê¸°ë°˜ì—ì„œ ì‚¬ìš©í•˜ë ¤ê³  í–ˆê³ , ëª¨ë“ˆí™”ë¥¼ ë§¨ ì²˜ìŒ ì‹œì‘í•¨. ìë°”ìŠ¤í¬ë¦½íŠ¸ V8ì—”ì§„ ì´í›„ì— CommonJS ëª¨ë“ˆ ë°œí‘œí•¨. ì„œë²„ì‚¬ì´ë“œ í™˜ê²½ì— ë” ì í•©í•¨.
> 2.  **AMD** : CommonJSë³´ë‹¤ ë¸Œë¼ìš°ì € í™˜ê²½ì— ë” ì í•©í•¨.
> 3.  **UMD** : CommonJSì™€ AMDë¥¼ ë™ì‹œì— í˜¸í™˜í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§. ì‚¬ìš©ìì˜ ëª¨ë“ˆ ë¡œë”ë¥¼ í™•ì¸í•´ì„œ CommonJS, AMD, Window ë°©ì‹ìœ¼ë¡œ ë¶„ê¸°í•¨
> 4.  **ESM** : ECMAScript Module. ìë°”ìŠ¤í¬ë¦½íŠ¸ ES6ì—ì„œë¶€í„° ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“ˆ
>
> <br />
>
> ğŸ“š â†’ ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒ¨í‚¤ì§•ì„ ìœ„í•œ ë¹Œë“œ í…ŒìŠ¤íŠ¸ì˜€ê¸° ë•Œë¬¸ì—, ì‚¬ìš©ìì˜ í™˜ê²½ì„ ìµœëŒ€í•œ í¬ê´„í•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ìŠ¤í™íŠ¸ëŸ¼ì˜ ëª¨ë“ˆì„ ì œê³µí•˜ê¸°ìœ„í•´ì„œ UMDì™€ ESMì„ ì„ íƒí•¨

<br />

# í…ŒìŠ¤íŠ¸ í™˜ê²½

1. macOS Ventura 13.5.1

<br />

# í…ŒìŠ¤íŠ¸ ë°©ì‹

1. ê° ë¹„êµêµ° ë²ˆë“¤ 5íšŒ ì‹¤í–‰, ìµœì¥ ì‹œê°„ê³¼ ìµœì € ì‹œê°„ì„ ì œì™¸í•˜ê³  ë¹Œë“œ ì‹œê°„ì˜ ì‚°ìˆ í‰ê·  ë¹„êµ

1. scriptì— ëŒ€í•œ ì´ ì‹œê°„ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œ yarn ëª…ë ¹ì–´ ì‚¬ìš©
1. WebPack, RollUpì€ ë¹Œë“œ ì™„ë£Œ ì‹œ ì¸¡ì •ëœ ì‹œê°„ logê°€ ë‚´ì¥ë˜ì–´ìˆëŠ”ë° ESBuildëŠ” ì•„ë‹ˆì—ˆìŒ. <br/>
   ê·¸ë˜ì„œ `build.onEnd((result) => {})` `build.onStart(() => {})` API ì‚¬ìš© <br/> `metafile:true` configë¡œ ê°ê° íŒŒì¼ ë³„ ë¹Œë“œ ì‹œì‘ ì‹œì ê³¼ ì¢…ë£Œ ì‹œì  êµ¬í•¨

<br />

# ë²ˆë“¤ëŸ¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼

1. yarn script : `rm -rf dist && tsc --emitDeclarationOnly && build`
2. average = 5íšŒ ì‹¤í–‰ í›„, ìµœì¥ ì‹œê°„ê³¼ ìµœì € ì‹œê°„ì„ ì œì™¸í•˜ê³  ë¹Œë“œ ì‹œê°„ì˜ ì‚°ìˆ í‰ê· 

### ESBuild

|           | average                                           |
| --------- | ------------------------------------------------- |
| cjs (umd) | <span style={{ color: '#00c853' }}> 5.67ms</span> |
| js (esm)  | <span style={{ color: '#00c853' }}> 7.67ms</span> |
| total     | <span style={{ color: '#00c853' }}>2.35s </span>  |

|          |   1   |   2   |   3   |   4   |   5   |
| -------- | :---: | :---: | :---: | :---: | :---: |
| cjs(umd) |  6ms  |  5ms  |  5ms  | 10ms  |  6ms  |
| js(esm)  |  7ms  |  6ms  |  7ms  | 13ms  |  9ms  |
| total    | 2.24s | 2.27s | 2.29s | 2.50s | 2.76s |

### RollUp

|           | average                                            |
| --------- | -------------------------------------------------- |
| cjs (umd) | <span style={{ color: '#00c853' }}> 709ms </span>  |
| js (esm)  | <span style={{ color: '#00c853' }}> 432.6ms</span> |
| total     | <span style={{ color: '#00c853' }}>3.49s </span>   |

|          |   1   |   2   |   3   |   4   |   5   |
| -------- | :---: | :---: | :---: | :---: | :---: |
| cjs(umd) | 710ms | 709ms | 704ms | 708ms | 716ms |
| js(esm)  | 431ms | 430ms | 434ms | 438ms | 433ms |
| total    | 3.46s | 3.48s | 3.49s | 3.50s | 3.53s |

### WebPack

|           | average                                          |
| --------- | ------------------------------------------------ |
| cjs (umd) | <span style={{ color: '#00c853' }}> 412ms</span> |
| js (esm)  | <span style={{ color: '#00c853' }}> 395ms</span> |
| total     | <span style={{ color: '#00c853' }}>3.07s </span> |

|          |   1   |   2   |   3   |   4   |   5   |
| -------- | :---: | :---: | :---: | :---: | :---: |
| cjs(umd) | 415ms | 404ms | 410ms | 411ms | 431ms |
| js(esm)  | 379ms | 384ms | 391ms | 380ms | 409ms |
| total    | 2.97s | 3.02s | 3.02s | 3.17s | 3.86s |

<br />

# ë²ˆë“¤ëŸ¬ í…ŒìŠ¤íŠ¸ 1ì°¨ ê²°ë¡ 

| â†‘   | bundler |   esm   |  umd   | total |
| --- | ------- | :-----: | :----: | :---: |
| 1   | ESBuild | 7.67ms  | 5.67ms | 2.76s |
| 2   | WebPack |  395ms  | 412ms  | 3.07s |
| 3   | RollUp  | 432.6ms | 709ms  | 3.49s |

1. ESBuild : <br/>
   â‘  UMD ë²ˆë“¤ëŸ¬ë¥¼ ì œê³µí•˜ê³  ìˆì§€ ì•Šì•„ì„œ, ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ë§Œë“  Pluginì¸ 'umdWrapper'ë¥¼ ì‚¬ìš©í•¨ ([github issue ](https://github.com/evanw/esbuild/issues/507#issuecomment-1356794943))<br/>
   â‘¡ TypeScript Complierê°€ ë‚´ì¥ë˜ì–´ ìˆì–´ì„œ, ë³„ë„ì˜ transpile plugin í˜¹ì€ loaderê°€ ë¶ˆí•„ìš”í•¨

2. Webpack : <br/>
   â‘  TypeScript complieì„ ìœ„í•´ì„œ 'ts-loader'ë¥¼ ì‚¬ìš©í•¨ ([ê³µì‹ë¬¸ì„œ ](https://webpack.kr/guides/typescript/)) <br/>
   â‘¡ production modeë¡œ ë¹Œë“œ ì‹œ minify & mangle ê¸°ë³¸ìœ¼ë¡œ ì‹¤í–‰ë¨

3. RollUp : <br/>
   â‘  TypeScript complieì„ ìœ„í•´ì„œ 'typescript' pluginì„ ì‚¬ìš©í•¨ ([ê³µì‹ë¬¸ì„œ ](https://rollupjs.org/command-line-interface/#configplugin-plugin))<br/>
   â‘¡ minifyë¥¼ ìœ„í•´ì„œ 'terser' pluginì„ ì‚¬ìš©í•¨ (íƒ€ ë¼ì´ë¸ŒëŸ¬ë¦¬, íƒ€ ë²ˆë“¤ëŸ¬ ì°¸ê³ )

### â†’ ESBuild > WebPack > RollUp ìˆœìœ¼ë¡œ ë¹ ë¦„. <br/>

ESBuild > RollUp > Webpack ìˆœì„œì¼ ì¤„ ì•Œì•˜ëŠ”ë° ì˜ˆìƒê³¼ ë‹¤ë¥´ê²Œ RollUpì´ ê°€ì¥ ëŠë ¸ìŒ. <br/>

RollUpì´ TypeScript transpile pluginê³¼ minify pluginì„ ë‘ê°œ ë‹¤ ì‚¬ìš©í•˜ê³  ìˆì–´ì„œ plugin ì˜í–¥ì´ ìˆëŠ”ì§€ ì²´í¬í•˜ê³ ,
ì„¸ ê°œ ë²ˆë“¤ëŸ¬ ëª¨ë‘ ë²ˆë“¤ëŸ¬ ê°ê°ì—ì„œ ì¶”ì²œí•˜ê³  ìˆëŠ”, í˜¹ì€ ê°ê° íŠ¹ì§•ì— ë§ê²Œ ë‹¤ë¥¸ plugin, loaderë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ìµœëŒ€í•œ í†µì¼í•´ë³´ëŠ” ê³¼ì •ì´ í•„ìš”í•  ê²ƒ ê°™ìŒ.

<br />

## RollUpì´ ê°€ì¥ ëŠë ¸ë˜ ì´ìœ  ì°¾ê¸° (Plugin)

### 1. typescript O, minify O (ê¸°ì¡´ configuration)

|       | average                                            |
| ----- | -------------------------------------------------- |
| cjs   | <span style={{ color: '#00c853' }}> 709ms </span>  |
| js    | <span style={{ color: '#00c853' }}> 432.6ms</span> |
| total | <span style={{ color: '#00c853' }}>3.49s </span>   |

|       | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| cjs   | 710ms | 709ms | 704ms | 708ms | 716ms |
| js    | 431ms | 430ms | 434ms | 438ms | 433ms |
| total | 3.45s | 3.48s | 3.49s | 3.50s | 3.53s |

### 2. typescript X, minify X

|       | average                                           |
| ----- | ------------------------------------------------- |
| cjs   | <span style={{ color: '#00c853' }}> 21.3ms</span> |
| js    | <span style={{ color: '#00c853' }}> 4ms</span>    |
| total | <span style={{ color: '#00c853' }}>0.47s </span>  |

â†’ ë‹¤ë¥¸ pluginì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , RollUpì˜ ë‚´ì¥ configë§Œì„ ì‚¬ìš©í•´ `JavaScript` â†’ `JavaScript` bundleë§Œ ì‹¤í–‰í–ˆì„ ë•Œ í›¨ì”¬ ë¹ ë¥¸ ê²°ê³¼ ë‚˜ì˜´

|       | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| cjs   | 22ms  | 22ms  | 21ms  | 21ms  | 21ms  |
| js    | 4ms   | 4ms   | 4ms   | 4ms   | 5ms   |
| total | 0.48s | 0.47s | 0.47s | 0.47s | 0.47s |

### 3. typescript X, minify O

|       | average                                          |
| ----- | ------------------------------------------------ |
| cjs   | <span style={{ color: '#00c853' }}> 141ms</span> |
| js    | <span style={{ color: '#00c853' }}>112ms</span>  |
| total | <span style={{ color: '#00c853' }}> 0.75s</span> |

|       | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| cjs   | 142ms | 141ms | 141ms | 141ms | 141ms |
| js    | 112ms | 112ms | 112ms | 111ms | 113ms |
| total | 0.75s | 0.75s | 0.75s | 0.75s | 0.84s |

### 4. typescript O, minify X

|       | average                                            |
| ----- | -------------------------------------------------- |
| cjs   | <span style={{ color: '#00c853' }}> 592ms </span>  |
| js    | <span style={{ color: '#00c853' }}>325.67ms</span> |
| total | <span style={{ color: '#00c853' }}> 1.66s</span>   |

â†’ typescript pluginì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , minify ë„êµ¬ì¸ terser pluginì„ ì‚¬ìš©í•œ 3ë²ˆ ì¼€ì´ìŠ¤ì™€ ë¹„êµí•´ë´¤ì„ ë•Œ, typescript pluginì˜ transpile ê³¼ì •ì´ ê°€ì¥ ë§ì€ ì‹œê°„ì„ ì†Œë¹„í•˜ê³  ìˆìŒ

|       | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| cjs   | 596ms | 590ms | 585ms | 612ms | 592ms |
| js    | 337ms | 319ms | 327ms | 321ms | 329ms |
| total | 1.68s | 1.65s | 1.65s | 1.67s | 1.66s |

<br />

pluginì´ë‘ tscë¥¼ í•˜ë‚˜ì”© ë¹¼ ë´¤ì„ ë•Œ `@rollup/plugin-typescript` ê³¼ì •ì´ ê°€ì¥ ì˜¤ë˜ê±¸ë ¤ì„œ ëŒ€ì²´í•  ìˆ˜ ìˆëŠ” transpilerë¡œ babelì„ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°ë¡œí–ˆë‹¤.

<br />

## RollUp with Babel transpiler

```javascript
 plugins: [
      babel({
        extensions: [".ts", ".js"],
        babelHelpers: "bundled",
        exclude: "node_modules/**",
        presets: [["@babel/preset-typescript"]],
        plugins: [],
      }),
      terser(),
    ],
```

### 1. babel O, minify X tsc O

|       | average                                             |
| ----- | --------------------------------------------------- |
| cjs   | <span style={{ color: '#00c853' }}> 179.67ms</span> |
| js    | <span style={{ color: '#00c853' }}>52ms</span>      |
| total | <span style={{ color: '#00c853' }}> 2.40s </span>   |

|       | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| cjs   | 179ms | 180ms | 177ms | 180ms | 181ms |
| js    | 17ms  | 17ms  | 18ms  | 18ms  | 17ms  |
| total | 2.56s | 2.69s | 2.31s | 2.32s | 2.33s |

### 1. babel O, minify O tsc O

|       | average                                            |
| ----- | -------------------------------------------------- |
| cjs   | <span style={{ color: '#00c853' }}> 274.3ms</span> |
| js    | <span style={{ color: '#00c853' }}>100.67ms</span> |
| total | <span style={{ color: '#00c853' }}> 2.54s </span>  |

|       | 1     | 2     | 3     | 4     | 5     |
| ----- | ----- | ----- | ----- | ----- | ----- |
| cjs   | 287ms | 274ms | 274ms | 274ms | 275ms |
| js    | 101ms | 100ms | 101ms | 99ms  | 101ms |
| total | 2.59s | 2.52s | 2.52s | 2.51s | 2.68s |

### â†’ Babelì„ ì‚¬ìš©í•˜ë‹ˆê¹Œ ts-loaderë¥¼ ì‚¬ìš©í•œ WebPackë³´ë‹¤ ë¹ ë¥´ê²Œ ë‚˜ì™”ë‹¤.

ê·¸ë ‡ë‹¤ë©´ í†µì¼ëœ transpilerë¡œ ë¹„êµí•´ì„œ babel-loaderë¥¼ ì‚¬ìš©í•œ webpackë³´ë‹¤ëŠ”?

### 1-1. WebPack with Babel

```javascript
{
    loader: "babel-loader",
    options:{
                plugins: ["@babel/plugin-transform-typescript"],
            },
},

```

|       | average                                          |
| ----- | ------------------------------------------------ |
| cjs   | <span style={{ color: '#00c853' }}> 456ms</span> |
| js    | <span style={{ color: '#00c853' }}>436ms</span>  |
| total | <span style={{ color: '#00c853' }}> 2.97s</span> |

|       | 1      | 2      | 3      | 4      | 5      |
| ----- | ------ | ------ | ------ | ------ | ------ |
| cjs   | 456 ms | 508 ms | 443 ms | 469 ms | 443 ms |
| js    | 435 ms | 482 ms | 423 ms | 448 ms | 425 ms |
| total | 2.83s  | 3.09s  | 3.28s  | 3.00s  | 2.83s  |

babel-loaderë¥¼ ì‚¬ìš©í•œ WebPackë³´ë‹¤ ë¹¨ëë‹¤! <br/>

ì˜¤íˆë ¤ Webpackì€ babel-loaderë¥¼ ì‚¬ìš©í•˜ë‹ˆê¹Œ ts-loaderë¥¼ ì‚¬ìš©í–ˆì„ ë•Œë³´ë‹¤ ëŠë ¤ì¡Œë‹¤.

## RollUpì€ ë” ë¹¨ë¼ì§ˆ ìˆ˜ ìˆì„ê¹Œ? (complier ë¹„êµ)

ì´ì œ Babelê³¼ SWCë¥¼ ë¹„êµí•´ë³´ë ¤ê³  í–ˆëŠ”ë°<br/> RollUpì´ ì œê³µí•˜ê³  ìˆëŠ” [Plugins, Packages, and Resources ë¬¸ì„œâ†—ï¸](https://github.com/rollup/awesome)ì— SWC pluginì´ ì—†ì—ˆë‹¤ ...

# ê²°ë¡ 

1. ESBuildì— Typescript transpileì´ ë‚´ì¥ë˜ì–´ìˆëŠ”ê±´ TypeScript í™˜ê²½ì—ì„œ êµ‰ì¥íˆ ì¥ì ì¸ ê²ƒ ê°™ë‹¤.
2. TypeScript í™˜ê²½ì¸ì§€, ë‹¤ì–‘í•œ ê°œë°œ í™˜ê²½ì„ ì§€ì›í•´ì•¼í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°œë°œì¸ì§€, ì–´ë””ê¹Œì§€ ë³´ìˆ˜ì ìœ¼ë¡œ ì§„í–‰í• ì§€ í”„ë¡œì íŠ¸ by í”„ë¡œì íŠ¸, ì •ì±… by ì •ì±…ì´ê² ì§€ë§Œ ì–´ëŠì •ë„ ë²ˆë“¤ëŸ¬ê°€ íƒ„ìƒí•œ ì´ìœ ì™€ ì‹œì ì— ë”°ë¼ ì ì ˆí•œ ë²ˆë“¤ëŸ¬ê°€ ì¡´ì¬í•˜ëŠ” ê²ƒ ê°™ë‹¤.
